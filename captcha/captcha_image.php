<?php
session_start(); header("Content-Type: image/jpeg"); die(create_image()); function create_image(){ $md5 = md5(rand(0,9999)); $pass = substr($md5, 10, 5); $_SESSION["rand_code"] = $pass; $image = ImageCreatetruecolor(80, 20); $clr_white = ImageColorAllocate($image, 250, 250, 250); $clr_blue = ImageColorAllocate($image, 2, 64, 107); $clr_black = ImageColorAllocate($image, 86, 86, 86); imagefill($image, 0, 0, $clr_black); imagefontheight(15); imagefontwidth(15); imagestring($image, 15, 20, 3, $pass, $clr_white); imageline($image, 10, 10, 15, 5, $clr_blue);	imageline($image, 20, 12, 25, 10, $clr_blue); imageline($image, 30, 15, 33, 15, $clr_blue); imageline($image, 20, 10, 22, 15, $clr_blue); imageline($image, 15, 15, 20, 10, $clr_blue);	imageline($image, 25, 20, 20, 15, $clr_blue); imageline($image, 35, 10, 38, 15, $clr_blue); imageline($image, 45, 10, 50, 10, $clr_blue); imageline($image, 17, 13, 22, 13, $clr_blue);	imageline($image, 27, 10, 20, 10, $clr_blue); imageline($image, 35, 10, 38, 15, $clr_blue); imageline($image, 45, 10, 50, 10, $clr_blue); imageline($image, 60, 10, 55, 5, $clr_blue);	imageline($image, 70, 12, 75, 10, $clr_blue); imageline($image, 80, 15, 83, 15, $clr_blue); imageline($image, 75, 10, 72, 15, $clr_blue); return imagejpeg($image); imagedestroy($image); } 

?>